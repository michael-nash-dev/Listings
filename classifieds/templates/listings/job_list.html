{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Browse Jobs</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .card-img-top {
      height: 200px;
      object-fit: cover;
    }
  </style>
</head>

<body class="bg-light">
  <div class="container my-5">
    <h2 class="mb-4 text-center">Browse Jobs</h2>

    <!-- Filter Form -->
    <form method="get" class="row g-3 p-4 bg-white rounded shadow-sm mb-5">
      <div class="col-md-4">
        <input type="text" name="q" class="form-control" placeholder="Search for jobs here try: teaching jobs in Harare" value="{{ query|default_if_none:'' }}">
      </div>

      <div class="col-md-2">
        <input type="text" name="title" class="form-control" placeholder="Title" value="{{ filters.title }}">
      </div>

      <div class="col-md-2">
        <select name="category" class="form-select">
          <option value="">All Categories</option>
          <option value="it & software" {% if filters.category == 'it & software' %}selected{% endif %}>IT & Software</option>
          <option value="education" {% if filters.category == 'education' %}selected{% endif %}>Education</option>
          <option value="construction" {% if filters.category == 'construction' %}selected{% endif %}>Construction</option>
        </select>
      </div>

      <div class="col-md-2 d-flex gap-2">
        <input type="number" name="min_salary" class="form-control" placeholder="Min Salary" value="{{ filters.min_salary }}">
        <input type="number" name="max_salary" class="form-control" placeholder="Max Salary" value="{{ filters.max_salary }}">
      </div>

      <div class="col-md-1">
        <select name="status" class="form-select">
          <option value="">Status</option>
          <option value="pending" {% if filters.status == 'pending' %}selected{% endif %}>Pending</option>
          <option value="approved" {% if filters.status == 'approved' %}selected{% endif %}>Approved</option>
          <option value="rejected" {% if filters.status == 'rejected' %}selected{% endif %}>Rejected</option>
        </select>
      </div>

      <div class="col-md-1">
        <select name="is_active" class="form-select">
          <option value="">Active</option>
          <option value="true" {% if filters.is_active == 'true' %}selected{% endif %}>Yes</option>
          <option value="false" {% if filters.is_active == 'false' %}selected{% endif %}>No</option>
        </select>
      </div>

      <div class="col-12 text-end">
        <button type="submit" class="btn btn-primary">Search</button>
      </div>
    </form>

    <!-- Job Listings -->
    <div class="row">
      {% if jobs %}
        {% for job in jobs %}
          <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
              {% if job.image %}
                <img src="{{ job.image.url }}" class="card-img-top" alt="{{ job.title }}">
              {% else %}
                <img src="{% static 'images/default-job.jpg' %}" class="card-img-top" alt="No Image">
              {% endif %}
              <div class="card-body">
                <h5 class="card-title">
                  <a href="{% url 'job_detail' job.pk %}" class="text-decoration-none text-dark">
                    {{ job.title }}
                  </a>
                </h5>
                <p class="card-text">
                  <strong>Category:</strong> {{ job.get_category_display }}<br>
                  <strong>Salary:</strong> ${{ job.salary }}<br>
                  <strong>Status:</strong> {{ job.status|title }}
                  <strong>Active:</strong> {{ job.is_active|yesno:"Yes,No" }}<br>
                  <strong>Views:</strong> {{ job.views }}
                  <a href="{% url 'job_detail' job.pk %}"
                                class="btn btn-primary btn-sm w-100 rounded-pill">View Job Details</a>
                </p>
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="alert alert-info text-center">No jobs found. Try a different search.</div>
      {% endif %}
    </div>

    <div class="text-center mt-4">
      <a href="/" class="btn btn-outline-secondary">ðŸ”™ Back to Home</a>
    </div>
  </div>
</body>

</html>
